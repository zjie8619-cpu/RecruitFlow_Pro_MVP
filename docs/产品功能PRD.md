# RecruitFlow Pro MVP – 产品功能 PRD

## 1. 项目背景
- 招聘团队需要一套端到端的智能工具，实现从岗位配置、候选解析、AI 评分到邀约与报表的全链路自动化。
- 现有流程多依赖人工拷贝数据、手动校对，存在效率低、易出错、缺少追溯的问题。
- RecruitFlow Pro MVP 旨在验证「AI + 自动化工作流」的可行性，为后续企业级私有化部署奠定基础。

## 2. 产品目标
- **效率**：单次招募流程用时压缩 60%+，支持批量上传 200 份简历内 5 分钟完成评分。
- **一致性**：所有导出、通知、报表字段统一来源，提供自动校验，避免 NaN/字段缺失。
- **透明性**：AI 评分提供证据链、标签和风险提示，便于 HR 复核与背调。
- **可追溯**：导出批次、邀约邮件、ICS 日历信息与候选人 ID 绑定，便于审计。

## 3. 用户画像
| 角色 | 场景 | 需求 |
| --- | --- | --- |
| 招聘负责人 | 管控全局招聘效率 | 查看评分榜单、导出报表、跟踪邀约状态 |
| 招聘专员 | 执行每日筛选、邀约 | 快速解析批量简历、生成邀约邮件/日历 |
| 招聘主管 | 复核 AI 结果 | 获取证据链、风险提示，介入特殊候选 |

## 4. 关键流程
1. **岗位配置 & JD 生成**：输入岗位名称、要求；AI 生成 JD 文案并存入 `job_meta`。
2. **简历上传 & 解析**：支持 PDF/DOCX/TXT/图片 OCR，输出结构化 `resumes_df`。
3. **AI 匹配评分**：优先 `ai_match_resumes_df_ultra`，失败回退到启发式模型；保留短评、证据链、标签、风险。
4. **去重 & 排序**：按候选人 ID 合并；结合 TOP-N 配置输出 shortlist。
5. **邀约 & 日历**：模板化邮件，可选择 SMTP 发送；自动生成 ICS 并记录发送状态。
6. **报表导出**：调用 `build_export_row` + `export_round_report`，并执行 `validate_export_csv`，输出 CSV/XLSX。

## 5. 功能需求
### 5.1 岗位与配置
- U-01：支持保存岗位名称、必备/加分/排除条件。
- U-02：JD 生成后可编辑并回写 session state。

### 5.2 简历解析
- R-01：多格式解析，含文本、联系方式、教育/经验结构化。
- R-02：姓名识别需过滤常见非人名词（“专业技能”等），回退到文件名推断。
- R-03：解析结果可在 UI 中预览，支持导出。

### 5.3 AI 评分
- S-01：输出总分 + 四维度细分 + 证据链 JSON。
- S-02：失败时 fallback 为启发式打分，标记 `fallback=True`。
- S-03：`score_detail`、`reasoning_chain` 必须 JSON 序列化。

### 5.4 去重 & 排序
- D-01：按邮箱、手机号、文件哈希去重。
- D-02：用户可配置 TOP-N；系统保存 `topn_ids` 供后续导出。

### 5.5 邀约与日历
- I-01：支持批量编辑邀请模板（岗位、候选人姓名占位符）。
- I-02：SMTP 发送成功后更新 `invite_results`，记录 `email_sent_at`。
- I-03：自动生成 ICS，字段包括时间、地点、会议链接。

### 5.6 报表导出
- E-01：`build_export_row` 统一字段来源，固定导出顺序。
- E-02：`validate_export_csv` 检查列顺序、空值、JSON 合法性、布尔“是/否”。
- E-03：导出文件命名 `recruit_round_{日期时间}.csv/xlsx`，并在 UI 显示下载链接。

## 6. 非功能需求
- N-01：本地运行、无云依赖；所有数据保存在本地 `data/` 与 SQLite。
- N-02：支持 Windows 10 + Python 3.11 环境。
- N-03：核心函数（CSV 导出、姓名解析）需具备单元测试。
- N-04：导出完成前必须通过 `validate_export_csv`，否则阻断下载并提示。
- N-05：日志需包含导出批次号、候选 ID、邮件发送结果。

## 7. 依赖与风险
- 依赖：PyMuPDF/pdfplumber/pytesseract（解析），OpenAI/GPT API（评分），SMTP 服务。
- 风险：
  - OCR 低质量导致姓名/电话缺失 → 需要手动编辑入口。
  - SMTP 凭据错误 → 添加即时错误提示。
  - 大批量解析性能瓶颈 → 后续迭代引入异步队列。

## 8. 里程碑
| 里程碑 | 范围 | 验收 |
| --- | --- | --- |
| M1 – MVP 出样 | 6 大流程全链路打通，支持 CSV 导出 | 在 50 份简历集上完成端到端演示 |
| M2 – 导出稳定性 | 引入 `build_export_row`、`validate_export_csv`，清理旧逻辑 | 导出 5 次不出现缺列/NaN |
| M3 – 邀约闭环 | SMTP + ICS + 导出面试字段 | 真实邮箱测试成功率 ≥ 95% |
| M4 – 解析精度 | 姓名识别 > 98%，联系方式识别 > 95% | 通过人工抽样验收 |

## 9. 交付物
- Streamlit 前端 + backend services。
- `docs/使用说明.md`、`docs/Ultra引擎集成指南.md` 等运维文档。
- 本 PRD 文件。

## 10. 未来扩展
- 接入企业邮箱 API、短信提醒。
- 多模型投票评分、引入多轮对话式反馈。
- 招聘看板（Offer 率、面试率）和管控指标。

