# RecruitFlow Pro MVP - 使用说明

## 🚀 一键启动程序

### 方法一：双击启动（推荐）

1. **Windows 用户**：双击 `启动程序.bat` 文件
2. **PowerShell 用户**：右键点击 `启动程序.ps1`，选择"使用 PowerShell 运行"

### 方法二：命令行启动

打开命令行（CMD 或 PowerShell），进入项目目录，运行：

```bash
# Windows CMD
启动程序.bat

# PowerShell
.\启动程序.ps1

# 或直接使用 Python
.venv\Scripts\python.exe -m streamlit run app/streamlit_app.py
```

### 方法三：创建桌面快捷方式

1. 右键点击 `启动程序.bat`
2. 选择"发送到" -> "桌面快捷方式"
3. 双击桌面快捷方式即可启动

---

## 📋 首次使用前准备

### 1. 安装 Python（如果还没有）

- 下载 Python 3.8+：https://www.python.org/downloads/
- 安装时勾选"Add Python to PATH"

### 2. 创建虚拟环境（如果还没有）

```bash
python -m venv .venv
```

### 3. 安装依赖

```bash
# Windows
.venv\Scripts\pip install -r requirements.txt

# 或使用国内镜像（更快）
.venv\Scripts\pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### 4. 配置环境变量（可选）

在项目根目录创建 `.env` 文件，添加以下配置：

```env
# AI 配置（二选一）
SILICONFLOW_API_KEY=your_siliconflow_api_key
SILICONFLOW_BASE_URL=https://api.siliconflow.cn/v1
AI_MODEL=Qwen2.5-32B-Instruct

# 或使用 OpenAI
OPENAI_API_KEY=your_openai_api_key
OPENAI_BASE_URL=https://api.openai.com/v1
AI_MODEL=gpt-4o-mini

# 邮件配置（可选）
SMTP_SERVER=smtp.exmail.qq.com
SMTP_PORT=587
SMTP_USER=your_email@company.com
SMTP_PASSWORD=your_password
```

---

## 🎯 程序功能说明

### 标签页 1：生成 JD（岗位描述）

1. **智能生成 JD**
   - 填写岗位名称、必备技能、加分项、排除项
   - 点击"生成 JD"，AI 会自动生成：
     - 长版 JD（用于 Boss 直聘）
     - 短版 JD（用于社媒/内推）
     - 能力维度评分表
     - 面试题目

2. **导出能力维度评分表**
   - 点击"导出能力维度评分表（Excel）"下载 Excel 文件

3. **保存到系统**
   - 点击"写入系统（保存 JD + 题库）"保存到数据库

### 标签页 2：AI 智能匹配

1. **上传简历**
   - 支持格式：PDF、DOCX、TXT、JPG、JPEG、PNG
   - 可以批量上传多份简历

2. **填写 JD 文本**
   - 系统会自动带入 AI 生成的长版 JD
   - 可以手动编辑

3. **AI 批量匹配并打分**
   - 点击"用 AI 批量匹配并打分"
   - 系统会自动：
     - 解析简历
     - AI 评分（技能匹配度、经验相关性、成长潜力、稳定性）
     - 生成评价和证据
     - 保存结果到 `data/ai_match_results.csv`

### 标签页 3：去重 & 排序

- 查看 Top-N 候选人
- 系统会自动去重并按总分排序

### 标签页 4：一键邀约 + 自动排期

1. **选择候选人**
   - 选择要邀约的候选人数（Top-N）

2. **填写面试信息**
   - 面试时间
   - 面试组织者邮箱
   - 企业微信配置（可选）

3. **生成邀约**
   - 点击"一键生成邀约邮件 + ICS"
   - 系统会自动生成：
     - 个性化邀约邮件
     - ICS 日历文件
     - 企业微信消息（可复制）
     - 邮件导入文件

4. **企业微信邀约**
   - 查看每个候选人的企业微信消息
   - 复制消息内容，在企业微信中发送

5. **邮件导入企业邮箱**
   - 生成 .eml 文件：可导入 Outlook、企业邮箱
   - 生成 Outlook CSV：批量导入联系人
   - SMTP 直接发送：配置 SMTP 后可直接发送邮件

### 标签页 5：面试包 & 导出报表

- 导出本轮报表（CSV 和 Excel）

---

## 🔧 常见问题

### Q1: 启动后浏览器没有自动打开？

**A:** 手动在浏览器中访问：http://localhost:8501

### Q2: 端口 8501 被占用？

**A:** 
启动脚本已自动处理端口占用问题：
1. **自动关闭旧进程**：脚本会自动检测并关闭占用端口的旧进程
2. **自动切换端口**：如果无法关闭，会自动使用端口 8502
3. **手动处理**：如果仍有问题，可以：
   - 关闭其他正在运行的 Streamlit 应用
   - 或修改启动脚本中的端口号

### Q3: 导入错误？

**A:** 
1. 确保虚拟环境已激活
2. 确保已安装所有依赖：`pip install -r requirements.txt`
3. 清除 Python 缓存：删除所有 `__pycache__` 文件夹

### Q4: AI 功能不可用？

**A:** 
1. 检查 `.env` 文件中的 API Key 配置
2. 确保网络可以访问 API 服务器
3. 查看页面底部的"AI 连接诊断"获取详细错误信息

### Q5: PDF 解析失败？

**A:** 
1. 确保已安装 PDF 解析库：`pip install PyMuPDF pdfplumber`
2. 对于扫描版 PDF，需要安装 Tesseract OCR

### Q6: 邮件发送失败？

**A:** 
1. 检查 SMTP 配置是否正确
2. 企业邮箱可能需要使用授权码而非登录密码
3. 检查防火墙是否阻止了 SMTP 连接

---

## 📞 技术支持

如遇到问题，请检查：
1. Python 版本（需要 3.8+）
2. 依赖是否完整安装
3. `.env` 文件配置是否正确
4. 网络连接是否正常

---

## 🎉 快速开始

1. **双击 `启动程序.bat`**
2. **等待浏览器自动打开**（或手动访问 http://localhost:8501）
3. **开始使用！**

祝使用愉快！ 🚀

